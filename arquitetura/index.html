
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentação técnica para o desafio de Acesso à Informação">
      
      
        <meta name="author" content="Danielle Soares">
      
      
        <link rel="canonical" href="https://pedro-nuness.github.io/AcessoInformacao/arquitetura/">
      
      
        <link rel="prev" href="../raciocinio/">
      
      
        <link rel="next" href="../instalacao/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Arquitetura Técnica - Solução CGDF - Identificação de PII</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#arquitetura-do-sistema" class="md-skip">
          Pular para conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href=".." title="Solução CGDF - Identificação de PII" class="md-header__button md-logo" aria-label="Solução CGDF - Identificação de PII" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Solução CGDF - Identificação de PII
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Arquitetura Técnica
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Mudar para modo escuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Mudar para modo escuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Mudar para modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Mudar para modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando busca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Solução CGDF - Identificação de PII" class="md-nav__button md-logo" aria-label="Solução CGDF - Identificação de PII" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Solução CGDF - Identificação de PII
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Início
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../raciocinio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linha de Raciocínio
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Arquitetura Técnica
  

    
  </span>
  
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../instalacao/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guia de Instalação
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="arquitetura-do-sistema">Arquitetura do Sistema</h1>
<p>O sistema expõe uma API REST como ponto de entrada. A partir do momento em que um texto é enviado, a requisição é validada e rapidamente respondida com status HTTP de sucesso, evitando que o cliente fique bloqueado aguardando o processamento completo. Essa decisão arquitetural reduz latência percebida e protege o sistema contra sobrecarga direta na camada síncrona.</p>
<p>Após o recebimento do texto, o conteúdo e seus metadados iniciais são persistidos diretamente no banco de dados, que atua como a principal fonte de verdade do sistema. Essa persistência imediata garante rastreabilidade do processamento e permite que o fluxo assíncrono continue mesmo em cenários de falha parcial.</p>
<p>Com os dados persistidos, um evento é publicado em uma fila de mensagens, que pode ser implementada com RabbitMQ ou Kafka. A mensageria é um elemento central da arquitetura, pois desacopla completamente a entrada do sistema do processamento pesado. Isso permite escalar consumidores de forma independente, absorver picos de carga e aplicar estratégias de retry sem impactar diretamente a API.</p>
<p>O serviço de processamento consome mensagens dessa fila de forma assíncrona. Esse componente é responsável por executar a lógica principal de classificação, determinando se o texto contém ou não informações sensíveis. Após a análise, o serviço atualiza o status do registro no banco de dados, marcando-o como concluído ou com falha, além de persistir o resultado da classificação. Esse serviço é stateless e projetado para escalar horizontalmente conforme a demanda.</p>
<p>Uma vez que o processamento é finalizado, um worker dispatcher entra em ação. Esse componente monitora o banco de dados por meio de polling e identifica registros que atingiram estados finais de processamento. Ao detectar essas condições, o dispatcher é responsável por notificar sistemas externos por meio de um webhook. Para garantir resiliência nessa integração, a chamada externa passa por um circuito de circuit breaker, prevenindo falhas em cascata e protegendo o sistema contra indisponibilidades externas.</p>
<p>Do ponto de vista operacional, essa arquitetura prioriza desacoplamento e tolerância a falhas. Mesmo que o serviço externo esteja indisponível ou o processamento sofra atrasos, a API continua respondendo corretamente e o sistema mantém consistência interna.</p>
<p>Os testes de carga realizados com o k6 ajudam a evidenciar esse comportamento. Em um primeiro cenário, com baixa concorrência, o sistema apresentou desempenho bastante eficiente. Foram executadas 100 iterações, todas bem-sucedidas, com latência end-to-end média em torno de 560ms e tempo médio de resposta do POST de aproximadamente 28ms. O polling praticamente não ocorreu, com valor médio igual a 1, indicando que o processamento foi rápido o suficiente para que o resultado estivesse disponível quase imediatamente. Um trecho representativo do output do k6 nesse cenário é:</p>
<div class="highlight"><pre><span></span><code>TOTAL RESULTS 

checks_total.......: 100     4.497343/s
checks_succeeded...: 100.00% 100 out of 100
checks_failed......: 0.00%   0 out of 100

CUSTOM
completed......................: 97     4.362423/s
failed.........................: 3      0.13492/s
latency_e2e....................: avg=560.48ms min=513ms    med=520ms    max=900ms    p(90)=664ms    p(95)=720.39ms
latency_post...................: avg=28.68ms  min=6ms      med=11ms     max=380ms    p(90)=60.9ms   p(95)=108.64ms
poll_count.....................: avg=1        min=1        med=1        max=1        p(90)=1        p(95)=1       

HTTP
http_req_duration..............: avg=23.81ms  min=4.47ms   med=8.03ms   max=362.09ms p(90)=64.58ms  p(95)=110.94ms
    { expected_response:true }...: avg=23.81ms  min=4.47ms   med=8.03ms   max=362.09ms p(90)=64.58ms  p(95)=110.94ms
http_req_failed................: 0.00%  0 out of 313
http_reqs......................: 313    14.076684/s

EXECUTION
iteration_duration.............: avg=1.15s    min=513.59ms med=521.13ms max=20.33s   p(90)=709.82ms p(95)=876.75ms
iterations.....................: 100    4.497343/s
vus............................: 3      min=3        max=11
vus_max........................: 50     min=50       max=50

NETWORK
data_received..................: 1.5 MB 66 kB/s
data_sent......................: 325 kB 15 kB/s
</code></pre></div>
<p>Esse resultado demonstra que, sob carga controlada, o sistema se comporta de forma extremamente estável, com baixa latência e alto throughput.</p>
<p>No segundo cenário, o sistema foi submetido a alta concorrência, alcançando até 200 usuários virtuais simultâneos. Nesse contexto, embora nenhuma falha HTTP tenha sido registrada, a latência end-to-end aumentou significativamente, atingindo uma média de aproximadamente 12 segundos. Esse aumento está diretamente relacionado ao crescimento da fila e ao tempo de espera até que o processamento assíncrono fosse concluído. O polling médio subiu para cerca de 21 tentativas, evidenciando que o dispatcher precisou consultar o banco diversas vezes até encontrar o status final do processamento. Um recorte do output do k6 nesse cenário ilustra bem esse comportamento:</p>
<div class="highlight"><pre><span></span><code>TOTAL RESULTS 

checks_total.......: 301     10.543627/s
checks_succeeded...: 100.00% 301 out of 301
checks_failed......: 0.00%   0 out of 301

CUSTOM
completed......................: 301    10.543627/s
latency_e2e....................: avg=12.11s    min=539ms    med=13.17s  max=19.45s   p(90)=18.96s   p(95)=19.15s  
latency_post...................: avg=67.11ms   min=8ms      med=19ms    max=703ms    p(90)=183ms    p(95)=253ms   
poll_count.....................: avg=21.385382 min=1        med=23      max=35       p(90)=34       p(95)=34      

HTTP
http_req_duration..............: avg=60.31ms   min=3.94ms   med=38.32ms max=693.55ms p(90)=131.11ms p(95)=145.93ms
    { expected_response:true }...: avg=60.31ms   min=3.94ms   med=38.32ms max=693.55ms p(90)=131.11ms p(95)=145.93ms
http_req_failed................: 0.00%  0 out of 6738
http_reqs......................: 6738   236.023123/s

EXECUTION
dropped_iterations.............: 699    24.485035/s
iteration_duration.............: avg=12.11s    min=539.89ms med=13.17s  max=19.45s   p(90)=18.96s   p(95)=19.15s  
iterations.....................: 301    10.543627/s
vus............................: 11     min=11        max=200
vus_max........................: 200    min=100       max=200

NETWORK
data_received..................: 23 MB  792 kB/s
data_sent......................: 1.7 MB 59 kB/s
</code></pre></div>
<p>Apesar do aumento da latência total, o tempo de resposta da API permaneceu baixo, o que confirma a eficácia da estratégia de processamento assíncrono. A mensageria conseguiu absorver o pico de requisições sem perda de dados, e o sistema manteve consistência e confiabilidade durante todo o teste.</p>
<p>De forma geral, a arquitetura demonstra-se robusta e bem alinhada para cenários reais de produção, especialmente quando a prioridade é confiabilidade e escalabilidade, mesmo que isso implique maior latência end-to-end em situações de alta carga. Como evolução natural, podem ser consideradas melhorias como redução da dependência de polling, adoção de eventos de conclusão, ajustes no paralelismo do serviço de processamento e implementação de filas de dead letter para tratamento de falhas.</p>
<p>Conclui-se que o sistema está tecnicamente bem fundamentado, com decisões arquiteturais coerentes e sustentadas pelos resultados observados nos testes de carga, sendo plenamente capaz de operar em ambientes de alto volume com comportamento previsível e resiliente.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "search.result.more.one": "mais 1 nesta p\u00e1gina", "search.result.more.other": "# mais nesta p\u00e1gina", "search.result.none": "Nenhum documento encontrado", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Ausente", "select.version": "Selecione a vers\u00e3o"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>